import { css } from 'linaria';
import intents from './intents.config.js';
import asOptions from './options';

const UX_SPACE_PADDING_SIZE = '--uxSpace--padding-size';
const UX_SPACE_GAP_SIZE = '--uxSpace--gap-size';
const UX_SPACE_PADDING_ADJUSTMENT = '--uxSpace--padding-adjustment';
const UX_SPACE_GAP_ADJUSTMENT = '--uxSpace--gap-adjustment';

/**
 * Creates size variations based on UX_SPACE_AS options
 *
 * @param {String} as - One of the possible options from UX_SPACE_AS
 * @returns {String} - a CSS declaration related to a possible option from UX_SPACE_AS
 */
function createSize(as) {
  return `
    &.ux-space--as-${as} {
      ${UX_SPACE_PADDING_SIZE}: calc(
        ${intents.uxSpace[as].paddingFactor} * 
        ${intents.ux.box.density} * 
        var(${UX_SPACE_PADDING_ADJUSTMENT}, 1)
      );
      ${UX_SPACE_GAP_SIZE}: calc(
        ${intents.uxSpace[as].gapFactor} *
        ${intents.ux.box.density} *
        var(${UX_SPACE_GAP_ADJUSTMENT}, 1)
      );
    }
  `;
}

/**
 * Creates dimension variations (inline & block)
 *
 * @param {String} dim - A CSS logical dimension
 * @returns {String} - a CSS declaration related to a CSS logical dimension
 */
function createDimension(dim) {
  return `
    &.ux-space--${dim} {
      &:empty {
        /** Container has no children, apply as spacer-gif */
        display: inline-flex;
        ${dim}-size: var(${UX_SPACE_PADDING_SIZE});
      }

      &:not(:empty) {
        /** Container has children, apply as padding */
        padding-${dim}: var(${UX_SPACE_PADDING_SIZE});
      }
    }
  `;
}

export default css`
  :global() {
    .ux-space {
      ${Object.values(asOptions).map(createSize).join('\n')}

      ${['inline', 'block'].map(createDimension).join('\n')}

      &.ux-space--gap {
        gap: var(${UX_SPACE_GAP_SIZE});
      }

      @media (max-width: 500px) {
        &.ux-space--as-module {
          ${UX_SPACE_PADDING_ADJUSTMENT}: .5;
        }

        &.ux-space--as-block {
          ${UX_SPACE_PADDING_ADJUSTMENT}: .75;
          ${UX_SPACE_GAP_ADJUSTMENT}: .5;
        }
      }
    }
  }
`;
